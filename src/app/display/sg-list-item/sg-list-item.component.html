<div class="wrapper border-bottom p-1">
    <span class="badge badge-primary">
        <div class="icon-wrapper">
            <value-icon *ngIf="sg.type === 'Value'" class="sg-icon"></value-icon>
            <range-icon *ngIf="sg.type === 'Range'" class="sg-icon"></range-icon>
            <comparative-icon *ngIf="sg.type === 'Comparative'" class="sg-icon"></comparative-icon>
            <rank-icon *ngIf="sg.type === 'Rank'" class="sg-icon"></rank-icon>
            <powerlaw-icon *ngIf="sg.type === 'PowerLaw'" class="sg-icon"></powerlaw-icon>
            <normal-icon *ngIf="sg.type === 'Normal'" class="sg-icon"></normal-icon>
            <linear-icon *ngIf="sg.type === 'Linear'" class="sg-icon"></linear-icon>
        </div>
        {{ L[sg.type] }}
    </span>
    <span class="badge badge-secondary ml-1">{{ sg.query.recentProgress.processedPercent() | percent}}</span>
    <span class="badge badge-warning ml-1"><fa-icon [icon]="['far', 'bell']"></fa-icon></span>
    <span class="badge badge-danger ml-1"><fa-icon [icon]="['fas', 'exclamation-triangle']"></fa-icon></span>

    <div class="display my-1">
        <sg-display [safeguard]="sg"></sg-display>
    </div>

    <div class="d-flex">
        <p-indicator *ngIf="sg.isP()" [p]="sg.p()" class="flex-grow-1"></p-indicator>

        <boolean-indicator *ngIf="sg.isBoolean()" [t]="sg.t()" class="flex-grow-1"></boolean-indicator>

        <quality-indicator *ngIf="sg.isQuality()" [q]="sg.q()" class="flex-grow-1"></quality-indicator>

        <error-indicator *ngIf="sg.isError()" [e]="sg.e()" class="flex-grow-1"></error-indicator>

        <button type="button" class="btn btn-sm btn-warning ml-1" (click)="toggleAlarm()">
            <fa-icon [icon]="['far', 'bell']" [hidden]="alarmOpen"></fa-icon>
            <fa-icon [icon]="['fas', 'bell']" [hidden]="!alarmOpen"></fa-icon>
        </button>
    </div>

    <div class="p-1 alarm-border rounded mt-1" *ngIf="alarmOpen">
        <h6 class="m-1">Alert me</h6>
        <hr class="alarm-border my-1 sep">
        <div class="form-check">
            <input class="form-check-input" type="checkbox" [id]="id+1">
            <label class="form-check-label" [for]="id+1">
                when the progress reaches to a point
            </label>
        </div>
        <div class="form-inline my-1">
            <input type="number" class="form-control form-control-sm  text-align-right" [min]="ceil(sg.query.visibleProgress.processedPercent() * 100)" max="100" style="width:60px">
            <span class="ml-1">%</span>
        </div>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" [id]="id+2">
            <label class="form-check-label" [for]="id+2">
                after a certain period of time
            </label>
        </div>

        <div class="form-inline my-1">
            <input type="number" class="form-control form-control-sm  text-align-right" min="1" style="width:60px">
            <select class="form-control form-control-sm ml-1">
                <option>seconds</option>
                <option selected>minutes</option>
                <option>hours</option>
            </select>
        </div>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" [id]="id+2">
            <label class="form-check-label" [for]="id+2">
                when the validity measure meets a criterion
            </label>
        </div>
        <div class="form-inline my-1">
            <em>{{ sg.validityName() }}</em>
            <span class="ml-1">{{ sg.isP() || sg.isError() ? '>' : '<'}}</span>
            <input type="number" class="form-control form-control-sm ml-1" min="0" style="width:100px">
        </div>
    </div>

    <div class="p-1 alarm-border rounded mt-1">
        <h6 class="m-1">Recent Activity</h6>
        <p><em>p</em> has reached to a target (0.05).</p>
        <hr class="alarm-border my-1 sep">

        <button class="btn btn-sm btn-outline-secondary mb-1" style="width:100%">Notify me if it happens again.</button>
        <button class="btn btn-sm btn-outline-secondary mb-1" style="width:100%">Remove the alarm.</button>
        <button class="btn btn-sm btn-outline-secondary mb-1" style="width:100%">Set the constant to the current value.</button>
        <button class="btn btn-sm btn-outline-secondary mb-1" style="width:100%">Manually set the constant.</button>
        <button class="btn btn-sm btn-outline-secondary mb-1" style="width:100%">Set a new <em>p</em> value for the alert.</button>
        <button class="btn btn-sm btn-outline-danger" style="width:100%">Remove this PVA-Guard.</button>
    </div>
    <!--<fa-icon [icon]="['far', 'clock']"></fa-icon>
    <p class="m-0">Updated {{ sg.lastUpdatedAt | amTimeAgo }}</p>
    <p class="m-0">Created {{ sg.createdAt | amTimeAgo }}</p> -->

    <button type="button" class="remove px-2 py-1" aria-label="Close" (click)="removeClicked.emit(sg)">
        <fa-icon [icon]="['fas', 'times']"></fa-icon>
    </button>

</div>
